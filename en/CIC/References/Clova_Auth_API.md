# Clova Auth API
To connect your client with CIC, you must [create a Clova access token](/CIC/Guides/Interact_with_CIC.md#CreateClovaAccessToken). The following explains the Clova Auth API, which is provided by the Clova authorization server to help you with the token creation.

## Base URL
The base URL of the Clova authorization server is as follows.

<pre><code>{{ book.AuthServerBaseURL }}
</code></pre>

## /authorize {#authorize}
Returns an authorization code by receiving {{ book.TargetServiceForClientAuth }} account access token and [client credentials](/CIC/Guides/Interact_with_CIC.md#ClientAuthInfo) as parameters. An authorization code is credential information necessary for generation of a Clova access token.

<div class="note">
  <p><strong>Note!</strong></p>
  <p>Typically, user authentication is handled by an app paired with a client device. However, transferring a Clova access token from paired app to client may have a potential security issue. As such, the paired app returns an authorization code instead. Then, the client passes the authorization code to the parameter of the <a href="#token">/token</a> API and obtains a Clova access token.</p>
</div>

### Scheme, method, path
{% raw %}
```
:method = {{GET|POST}}
:scheme = https
:path = /authorize
```
{% endraw %}

### Parameter

| Field name       | Type    | Field description                     | Required |
|---------------|---------|-----------------------------|---------|
| `client_id`     | string  | The client ID (See [Client credentials](/CIC/Guides/Interact_with_CIC.md#ClientAuthInfo))          | Yes |
| `device_id`     | string  | The UUID of the client device. Use a MAC address or create a UUID hash value.                          | Yes |
| `model_id`      | string  | The model ID of the client device                                                                          | No |
| `response_type` | string  | The response type. Only `"code"` is supported at the moment.                                                           | Yes |
| `state`         | string  | The state token value (URL encoding applied) used by the client to prevent cross-site request forgery) attacks | Yes |

### Request Example

<pre><code>{{ book.AuthServerBaseURL }}authorize?client_id=c2Rmc2Rmc2FkZ2FzZnNhZGZ
                               &amp;device_id=test_device
                               &amp;model_id=test_model
                               &amp;response_type=code
                               &amp;state=95%2FKjaJfMlakjdfTVbES5ccZQ%3D%3D
</code></pre>

### Response field

| Field name       | Type    | Field description                     |
|---------------|---------|-----------------------------|
| `code`  | string | The authorization code generated from the authorization server                                                        |
| `state` | string | The decrypted state token value (URL decoding applied) passed from the client to prevent cross-site request forgery attacks |


### Response Example
{% raw %}
```json
{
    "code": "cnl__eCSTdsdlkjfweyuxXvnlA",
    "state": "95/KjaJfMlakjdfTVbES5ccZQ=="
}
```
{% endraw %}

### See also
* [Client credentials](/CIC/Guides/Interact_with_CIC.md#ClientAuthInfo)
* [Creating Clova access token](/CIC/Guides/Interact_with_CIC.md#CreateClovaAccessToken)
* [`/token`](#token)


## /token {#token}
Creates, refreshes or deletes Clova access tokens using authorization codes issued through the [/authorize](#authorize) API. Depending on the `grant_type` parameter value, it performs different actions and returns different values.

### Scheme, method, path
{% raw %}
```
:method = {{GET|POST}}
:scheme = https
:path = token
```
{% endraw %}

### Parameter

| Field name       | Type    | Field description                     | Required |
|---------------|---------|-----------------------------|---------|
| `access_token`  | string  | The Clova access token generated after authorization succeeds. This field is required when `grant_type` is set to `"delete"`.                                 | No |
| `client_id`     | string  | The client ID (See [Client credentials](/CIC/Guides/Interact_with_CIC.md#ClientAuthInfo))                                  | Yes |
| `client_secret` | string  | The client secret (See [Client credentials](/CIC/Guides/Interact_with_CIC.md#ClientAuthInfo))                              | Yes |
| `code`          | string  | The authorization code generated by the [/authorize](#authorize) API. This field is required when `grant_type` is set to `"authorization_code"`.        | No |
| `device_id`     | string  | The UUID of the client device                                                                                              | Yes |
| `grant_type`    | string  | An action identifier. <ul><li><code>"authorization_code"</code>: Generates a token</li><li><code>"refresh_token"</code>: Refreshes a token</li><li><code>"delete"</code>: Deletes a token</li></ul> | Yes |
| `model_id`      | string  | The model ID of the client device                                                                                                 | No |
| `refresh_token` | string  | The refresh token generated after authorization succeeds. This field is required when `grant_type` is set to `"refresh_token"`.                                      | No |
| `response_type` | string  | The response type. Only `"code"` is supported at the moment.                                                                                  | Yes |

### Request Example

<pre><code>// Example 1: When grant_type is authorization_code
{{ book.AuthServerBaseURL }}token?client_id=c2Rmc2Rmc2FkZ2FzZnNhZGZ
                           &amp;client_secret=66qo65asdfasdfaA7JasdfasfOqwnOq1rOyfgeydtCDrvYasfasf%3D
                           &amp;code=cnl__eCSTdsdlkjfweyuxXvnlA
                           &amp;device_id=test_device
                           &amp;grant_type=authorization_code
                           &amp;model_id=test_model

// Example 2: When grant_type is refresh_token
{{ book.AuthServerBaseURL }}token?client_id=c2Rmc2Rmc2FkZ2FzZnNhZGZ
                           &amp;client_secret=66qo65asdfasdfaA7JasdfasfOqwnOq1rOyfgeydtCDrvYasfasf%3D
                           &amp;refresh_token=GW-Ipsdfasdfdfs3IbHFBA
                           &amp;device_id=test_device
                           &amp;grant_type=refresh_token
                           &amp;model_id=test_model

// Example 3: When grant_type is delete
{{ book.AuthServerBaseURL }}token?client_id=c2Rmc2Rmc2FkZ2FzZnNhZGZ
                           &amp;client_secret=66qo65asdfasdfaA7JasdfasfOqwnOq1rOyfgeydtCDrvYasfasf%3D
                           &amp;access_token=xFcH08vYQcahQWouqIzWOw
                           &amp;device_id=test_device
                           &amp;grant_type=delete
                           &amp;model_id=test_model
</code></pre>


### Response field

| Field name       | Type    | Field description                     |
|---------------|---------|-----------------------------|
| `access_token`  | string  | The Clova access token                               |
| `client_id`     | string  | The client ID. It is included in response data when `grant_type` is set to `"delete"`. |
| `expires_in`    | number  | The amount of time that the Clova access token is deemed to be valid (in seconds)              |
| `refresh_token` | string  | The refresh token to refresh the Clova access token. It is not included in response data when `grant_type` is set to `"delete"`. |
| `token_type`    | string  | The type of the Clova access token. Always returns "Bearer". It is not included in response data when `grant_type` is set to `"delete"`. |

### Response Example
{% raw %}
```json
// Example 1: Response when grant_type is authorization_code
{
    "access_token": "XHapQasdfsdfFsdfasdflQQ7w",
    "expires_in": 332000,
    "refresh_token": "GW-Ipsdfasdfdfs3IbHFBA",
    "token_type": "Bearer"
}

// Example 2: Response when grant_type is refresh_token
{
    "access_token": "xFcH08vYQcahQWouqIzWOw",
    "expires_in": 12960000,
    "refresh_token": "drJK-soIQI6vqEukqsLU2g",
    "token_type": "Bearer"
}

// Example 3: Response when grant_type is delete
{
    "access_token": "xFcH08vYQcahQWouqIzWOw",
    "expires_in": 12960000,
    "client_id": "c2Rmc2Rmc2FkZ2FzZnNhZGZ"
}
```
{% endraw %}

### See also
* [Client credentials](/CIC/Guides/Interact_with_CIC.md#ClientAuthInfo)
* [Creating Clova access token](/CIC/Guides/Interact_with_CIC.md#CreateClovaAccessToken)
* [`/authorize`](#authorize)
