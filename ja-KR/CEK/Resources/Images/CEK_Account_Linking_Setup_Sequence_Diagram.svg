<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="973.4027px" preserveAspectRatio="none" style="width:888px;height:973px;" version="1.1" viewBox="0 0 888 973" width="888.2414px" zoomAndPan="magnify"><defs/><g><rect fill="#FFFFFF" height="427.9509" style="stroke: #000000; stroke-width: 0.9157127991675338;" width="9.1571" x="211.5297" y="306.1611"/><rect fill="#FFFFFF" height="27.4714" style="stroke: #000000; stroke-width: 0.9157127991675338;" width="9.1571" x="383.6837" y="232.4623"/><rect fill="#FFFFFF" height="46.2274" style="stroke: #000000; stroke-width: 0.9157127991675338;" width="9.1571" x="383.6837" y="352.3885"/><rect fill="#FFFFFF" height="211.907" style="stroke: #000000; stroke-width: 0.9157127991675338;" width="9.1571" x="383.6837" y="734.1119"/><rect fill="#FFFFFF" height="8.2414" style="stroke: #000000; stroke-width: 0.9157127991675338;" width="9.1571" x="703.2674" y="946.019"/><rect fill="#FFFFFF" height="46.2274" style="stroke: #000000; stroke-width: 0.9157127991675338;" width="9.1571" x="816.8158" y="444.8433"/><rect fill="#FFFFFF" height="46.2274" style="stroke: #000000; stroke-width: 0.9157127991675338;" width="9.1571" x="816.8158" y="641.6571"/><rect fill="#FFFFFF" height="46.2274" style="stroke: #000000; stroke-width: 0.9157127991675338;" width="9.1571" x="816.8158" y="780.3393"/><line style="stroke: #000000; stroke-width: 0.9157127991675338; stroke-dasharray: 5.0,5.0;" x1="43.0385" x2="43.0385" y1="93.8445" y2="962.5018"/><line style="stroke: #000000; stroke-width: 0.9157127991675338; stroke-dasharray: 5.0,5.0;" x1="215.6504" x2="215.6504" y1="93.8445" y2="962.5018"/><line style="stroke: #000000; stroke-width: 0.9157127991675338; stroke-dasharray: 5.0,5.0;" x1="387.8044" x2="387.8044" y1="93.8445" y2="962.5018"/><line style="stroke: #000000; stroke-width: 0.9157127991675338; stroke-dasharray: 5.0,5.0;" x1="615.8169" x2="615.8169" y1="93.8445" y2="962.5018"/><line style="stroke: #000000; stroke-width: 0.9157127991675338; stroke-dasharray: 5.0,5.0;" x1="707.846" x2="707.846" y1="93.8445" y2="962.5018"/><line style="stroke: #000000; stroke-width: 0.9157127991675338; stroke-dasharray: 5.0,5.0;" x1="821.3944" x2="821.3944" y1="93.8445" y2="962.5018"/><text fill="#000000" font-family="sans-serif" font-size="10.9886" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="47.6171" x="16.4828" y="82.2729">ユーザー</text><ellipse cx="43.0385" cy="11.9043" fill="#FEFECE" rx="7.3257" ry="7.3257" style="stroke: #000000; stroke-width: 1.8314255983350676;"/><path d="M43.0385,19.23 L43.0385,43.9542 M31.1342,26.5557 L54.9428,26.5557 M43.0385,43.9542 L31.1342,57.6899 M43.0385,43.9542 L54.9428,57.6899 " fill="none" style="stroke: #000000; stroke-width: 1.8314255983350676;"/><rect fill="#9EA0CA" height="66.3516" rx="4.5786" ry="4.5786" style="stroke: #FFFFFF; stroke-width: 1.3735691987513006;" width="182.2268" x="124.9948" y="26.5771"/><text fill="#FFFFFF" font-family="sans-serif" font-size="12.82" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="123.6212" x="154.2976" y="56.9361">クライアントアプリ</text><text fill="#FFFFFF" font-family="sans-serif" font-size="12.82" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="151.0926" x="140.5619" y="74.5447">またはペアリングアプリ</text><rect fill="#05D686" height="48.7429" rx="4.5786" ry="4.5786" style="stroke: #FFFFFF; stroke-width: 1.3735691987513006;" width="57.6899" x="359.4173" y="44.1858"/><text fill="#FFFFFF" font-family="sans-serif" font-size="12.82" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="26.5557" x="374.9844" y="74.5447">CEK</text><text fill="#000000" font-family="sans-serif" font-size="10.9886" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="35.7128" x="595.6712" y="82.2729">開発者</text><ellipse cx="616.2747" cy="11.9043" fill="#9EA0CA" rx="7.3257" ry="7.3257" style="stroke: #000000; stroke-width: 1.8314255983350676;"/><path d="M616.2747,19.23 L616.2747,43.9542 M604.3704,26.5557 L628.179,26.5557 M616.2747,43.9542 L604.3704,57.6899 M616.2747,43.9542 L628.179,57.6899 " fill="none" style="stroke: #000000; stroke-width: 1.8314255983350676;"/><rect fill="#9EA0CA" height="48.7429" rx="4.5786" ry="4.5786" style="stroke: #FFFFFF; stroke-width: 1.3735691987513006;" width="95.2341" x="660.2289" y="44.1858"/><text fill="#FFFFFF" font-family="sans-serif" font-size="12.82" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="64.0999" x="675.796" y="74.5447">Extension</text><rect fill="#9EA0CA" height="48.7429" rx="4.5786" ry="4.5786" style="stroke: #FFFFFF; stroke-width: 1.3735691987513006;" width="113.5484" x="764.6202" y="44.1858"/><text fill="#FFFFFF" font-family="sans-serif" font-size="12.82" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="82.4142" x="780.1873" y="74.5447">認可サーバー</text><rect fill="#FFFFFF" height="427.9509" style="stroke: #000000; stroke-width: 0.9157127991675338;" width="9.1571" x="211.5297" y="306.1611"/><rect fill="#FFFFFF" height="27.4714" style="stroke: #000000; stroke-width: 0.9157127991675338;" width="9.1571" x="383.6837" y="232.4623"/><rect fill="#FFFFFF" height="46.2274" style="stroke: #000000; stroke-width: 0.9157127991675338;" width="9.1571" x="383.6837" y="352.3885"/><rect fill="#FFFFFF" height="211.907" style="stroke: #000000; stroke-width: 0.9157127991675338;" width="9.1571" x="383.6837" y="734.1119"/><rect fill="#FFFFFF" height="8.2414" style="stroke: #000000; stroke-width: 0.9157127991675338;" width="9.1571" x="703.2674" y="946.019"/><rect fill="#FFFFFF" height="46.2274" style="stroke: #000000; stroke-width: 0.9157127991675338;" width="9.1571" x="816.8158" y="444.8433"/><rect fill="#FFFFFF" height="46.2274" style="stroke: #000000; stroke-width: 0.9157127991675338;" width="9.1571" x="816.8158" y="641.6571"/><rect fill="#FFFFFF" height="46.2274" style="stroke: #000000; stroke-width: 0.9157127991675338;" width="9.1571" x="816.8158" y="780.3393"/><line style="stroke: #000000; stroke-width: 0.9157127991675338;" x1="392.8408" x2="401.9979" y1="232.4623" y2="228.7994"/><line style="stroke: #000000; stroke-width: 0.9157127991675338;" x1="392.8408" x2="401.9979" y1="232.4623" y2="236.1251"/><line style="stroke: #000000; stroke-width: 0.9157127991675338;" x1="392.8408" x2="615.359" y1="232.4623" y2="232.4623"/><text fill="#000000" font-family="sans-serif" font-size="10.9886" lengthAdjust="spacingAndGlyphs" textLength="187.7211" x="410.6972" y="128.5003">認証関連情報を事前に登録(OAuth 2.0)</text><text fill="#000000" font-family="sans-serif" font-size="10.9886" lengthAdjust="spacingAndGlyphs" textLength="51.2799" x="410.6972" y="143.5934">- 認証URL</text><text fill="#000000" font-family="sans-serif" font-size="10.9886" lengthAdjust="spacingAndGlyphs" textLength="83.3299" x="410.6972" y="158.6866">- クライアントID</text><text fill="#000000" font-family="sans-serif" font-size="10.9886" lengthAdjust="spacingAndGlyphs" textLength="138.2726" x="410.6972" y="173.7798">- クライアントシークレット</text><text fill="#000000" font-family="sans-serif" font-size="10.9886" lengthAdjust="spacingAndGlyphs" textLength="91.5713" x="410.6972" y="188.8729">- リダイレクトURI</text><text fill="#000000" font-family="sans-serif" font-size="10.9886" lengthAdjust="spacingAndGlyphs" textLength="113.5484" x="410.6972" y="203.9661">- アクセストークンURI</text><text fill="#000000" font-family="sans-serif" font-size="10.9886" lengthAdjust="spacingAndGlyphs" textLength="14.6514" x="410.6972" y="219.0592">- ...</text><line style="stroke: #000000; stroke-width: 0.9157127991675338;" x1="209.6982" x2="200.5411" y1="306.1611" y2="302.4982"/><line style="stroke: #000000; stroke-width: 0.9157127991675338;" x1="209.6982" x2="200.5411" y1="306.1611" y2="309.8239"/><line style="stroke: #000000; stroke-width: 0.9157127991675338;" x1="43.0385" x2="210.6139" y1="306.1611" y2="306.1611"/><text fill="#000000" font-family="sans-serif" font-size="10.9886" lengthAdjust="spacingAndGlyphs" textLength="115.3798" x="69.5942" y="292.758">Extensionを有効にする</text><line style="stroke: #000000; stroke-width: 0.9157127991675338;" x1="381.8522" x2="372.6951" y1="352.3885" y2="348.7256"/><line style="stroke: #000000; stroke-width: 0.9157127991675338;" x1="381.8522" x2="372.6951" y1="352.3885" y2="356.0513"/><line style="stroke: #000000; stroke-width: 0.9157127991675338;" x1="220.6868" x2="382.768" y1="352.3885" y2="352.3885"/><text fill="#000000" font-family="sans-serif" font-size="10.9886" lengthAdjust="spacingAndGlyphs" textLength="110.8012" x="246.7846" y="338.9854">URLをリクエストする</text><line style="stroke: #000000; stroke-width: 0.9157127991675338;" x1="220.6868" x2="229.8439" y1="398.6159" y2="394.953"/><line style="stroke: #000000; stroke-width: 0.9157127991675338;" x1="220.6868" x2="229.8439" y1="398.6159" y2="402.2787"/><line style="stroke: #000000; stroke-width: 0.9157127991675338; stroke-dasharray: 2.0,2.0;" x1="220.6868" x2="387.3465" y1="398.6159" y2="398.6159"/><text fill="#000000" font-family="sans-serif" font-size="10.9886" lengthAdjust="spacingAndGlyphs" textLength="77.8356" x="265.5567" y="385.2128">認証URLを返す</text><line style="stroke: #000000; stroke-width: 0.9157127991675338;" x1="814.9844" x2="805.8273" y1="444.8433" y2="441.1804"/><line style="stroke: #000000; stroke-width: 0.9157127991675338;" x1="814.9844" x2="805.8273" y1="444.8433" y2="448.5061"/><line style="stroke: #000000; stroke-width: 0.9157127991675338;" x1="220.6868" x2="815.9001" y1="444.8433" y2="444.8433"/><text fill="#000000" font-family="sans-serif" font-size="10.9886" lengthAdjust="spacingAndGlyphs" textLength="217.0239" x="410.2393" y="431.4402">ログインページをリクエストする(認証URL)</text><line style="stroke: #000000; stroke-width: 0.9157127991675338;" x1="220.6868" x2="229.8439" y1="491.0707" y2="487.4078"/><line style="stroke: #000000; stroke-width: 0.9157127991675338;" x1="220.6868" x2="229.8439" y1="491.0707" y2="494.7335"/><line style="stroke: #000000; stroke-width: 0.9157127991675338; stroke-dasharray: 2.0,2.0;" x1="220.6868" x2="820.4787" y1="491.0707" y2="491.0707"/><text fill="#000000" font-family="sans-serif" font-size="10.9886" lengthAdjust="spacingAndGlyphs" textLength="109.8855" x="466.0978" y="477.6676">ログインページを返す</text><line style="stroke: #000000; stroke-width: 0.9157127991675338;" x1="220.6868" x2="259.1467" y1="537.2981" y2="537.2981"/><line style="stroke: #000000; stroke-width: 0.9157127991675338;" x1="259.1467" x2="259.1467" y1="537.2981" y2="549.2023"/><line style="stroke: #000000; stroke-width: 0.9157127991675338;" x1="221.6025" x2="259.1467" y1="549.2023" y2="549.2023"/><polygon fill="#000000" points="230.7596,545.5395,221.6025,549.2023,230.7596,552.8652,227.0968,549.2023" style="stroke: #000000; stroke-width: 0.9157127991675338;"/><text fill="#000000" font-family="sans-serif" font-size="10.9886" lengthAdjust="spacingAndGlyphs" textLength="131.8626" x="236.2539" y="523.895">ログインページを表示する</text><line style="stroke: #000000; stroke-width: 0.9157127991675338;" x1="209.6982" x2="200.5411" y1="595.4297" y2="591.7669"/><line style="stroke: #000000; stroke-width: 0.9157127991675338;" x1="209.6982" x2="200.5411" y1="595.4297" y2="599.0926"/><line style="stroke: #000000; stroke-width: 0.9157127991675338;" x1="43.0385" x2="210.6139" y1="595.4297" y2="595.4297"/><text fill="#000000" font-family="sans-serif" font-size="10.9886" lengthAdjust="spacingAndGlyphs" textLength="128.1998" x="63.1842" y="582.0267">アカウント認証(ログイン)</text><line style="stroke: #000000; stroke-width: 0.9157127991675338;" x1="814.9844" x2="805.8273" y1="641.6571" y2="637.9943"/><line style="stroke: #000000; stroke-width: 0.9157127991675338;" x1="814.9844" x2="805.8273" y1="641.6571" y2="645.32"/><line style="stroke: #000000; stroke-width: 0.9157127991675338;" x1="220.6868" x2="815.9001" y1="641.6571" y2="641.6571"/><text fill="#000000" font-family="sans-serif" font-size="10.9886" lengthAdjust="spacingAndGlyphs" textLength="109.8855" x="463.8085" y="628.2541">認証をリクエストする</text><line style="stroke: #000000; stroke-width: 0.9157127991675338;" x1="220.6868" x2="229.8439" y1="687.8845" y2="684.2217"/><line style="stroke: #000000; stroke-width: 0.9157127991675338;" x1="220.6868" x2="229.8439" y1="687.8845" y2="691.5474"/><line style="stroke: #000000; stroke-width: 0.9157127991675338; stroke-dasharray: 2.0,2.0;" x1="220.6868" x2="820.4787" y1="687.8845" y2="687.8845"/><text fill="#000000" font-family="sans-serif" font-size="10.9886" lengthAdjust="spacingAndGlyphs" textLength="253.6524" x="394.2144" y="674.4815">Authorization codeをリダイレクトURIと一緒に返す</text><line style="stroke: #000000; stroke-width: 0.9157127991675338;" x1="381.8522" x2="372.6951" y1="734.1119" y2="730.4491"/><line style="stroke: #000000; stroke-width: 0.9157127991675338;" x1="381.8522" x2="372.6951" y1="734.1119" y2="737.7748"/><line style="stroke: #000000; stroke-width: 0.9157127991675338;" x1="216.1082" x2="382.768" y1="734.1119" y2="734.1119"/><text fill="#000000" font-family="sans-serif" font-size="10.9886" lengthAdjust="spacingAndGlyphs" textLength="124.5369" x="237.6275" y="720.7089">Authorization codeを渡す</text><line style="stroke: #000000; stroke-width: 0.9157127991675338;" x1="814.9844" x2="805.8273" y1="780.3393" y2="776.6765"/><line style="stroke: #000000; stroke-width: 0.9157127991675338;" x1="814.9844" x2="805.8273" y1="780.3393" y2="784.0022"/><line style="stroke: #000000; stroke-width: 0.9157127991675338;" x1="392.8408" x2="815.9001" y1="780.3393" y2="780.3393"/><text fill="#000000" font-family="sans-serif" font-size="10.9886" lengthAdjust="spacingAndGlyphs" textLength="308.5952" x="450.5307" y="766.9363">アクセストークンURIにauthorization codeをパラメータで渡す</text><line style="stroke: #000000; stroke-width: 0.9157127991675338;" x1="392.8408" x2="401.9979" y1="826.5667" y2="822.9039"/><line style="stroke: #000000; stroke-width: 0.9157127991675338;" x1="392.8408" x2="401.9979" y1="826.5667" y2="830.2296"/><line style="stroke: #000000; stroke-width: 0.9157127991675338; stroke-dasharray: 2.0,2.0;" x1="392.8408" x2="820.4787" y1="826.5667" y2="826.5667"/><text fill="#000000" font-family="sans-serif" font-size="10.9886" lengthAdjust="spacingAndGlyphs" textLength="120.8741" x="546.6805" y="813.1637">アクセストークンを返す</text><line style="stroke: #000000; stroke-width: 0.9157127991675338;" x1="392.8408" x2="431.3007" y1="887.8873" y2="887.8873"/><line style="stroke: #000000; stroke-width: 0.9157127991675338;" x1="431.3007" x2="431.3007" y1="887.8873" y2="899.7916"/><line style="stroke: #000000; stroke-width: 0.9157127991675338;" x1="393.7565" x2="431.3007" y1="899.7916" y2="899.7916"/><polygon fill="#000000" points="402.9136,896.1287,393.7565,899.7916,402.9136,903.4544,399.2508,899.7916" style="stroke: #000000; stroke-width: 0.9157127991675338;"/><text fill="#000000" font-family="sans-serif" font-size="10.9886" lengthAdjust="spacingAndGlyphs" textLength="131.8626" x="408.4079" y="859.3911">ユーザーアカウント情報に</text><text fill="#000000" font-family="sans-serif" font-size="10.9886" lengthAdjust="spacingAndGlyphs" textLength="142.8512" x="408.4079" y="874.4843">アクセストークンを保存する</text><line style="stroke: #000000; stroke-width: 0.9157127991675338;" x1="701.436" x2="692.2789" y1="946.019" y2="942.3561"/><line style="stroke: #000000; stroke-width: 0.9157127991675338;" x1="701.436" x2="692.2789" y1="946.019" y2="949.6818"/><line style="stroke: #000000; stroke-width: 0.9157127991675338;" x1="388.2622" x2="702.3517" y1="946.019" y2="946.019"/><text fill="#000000" font-family="sans-serif" font-size="10.9886" lengthAdjust="spacingAndGlyphs" textLength="274.7138" x="408.4079" y="932.6159">アクセストークンを含めてユーザーのリクエストを渡す</text><!--
@startuml
scale max 880 width
skinparam sequenceMessageAlign center
skinparam shadowing false
skinparam roundcorner 10
skinparam padding 10
skinparam defaultFontSize 12
skinparam defaultFontName sans-serif
skinparam sequence {
	ArrowColor #000000
	ActorBorderColor #000000
	ActorFontStyle Bolder

	LifeLineBorderColor #000000
	LifeLineBackgroundColor transparent
	ParticipantBorderColor transparent
	ParticipantFontSize 14
	ParticipantFontColor #ffffff
	ParticipantFontStyle bold

	BoxBorderColor #000000
	BoxFontColor #ffffff
    BoxFontSize 14
    BoxFontStyle bold
}
skinparam note {
	BackgroundColor #9EA0CA
	BorderColor #ffffff
	FontColor #ffffff
	FontSize 14
	FontStyle bold
}
hide footbox

actor "ユーザー" as user
participant "クライアントアプリ\nまたはペアリングアプリ" as app #9EA0CA
participant CEK as cek #05D686
actor "開発者" as dev #9EA0CA
participant Extension as ext #9EA0CA
participant "認可サーバー" as auth #9EA0CA

dev ->> cek: 認証関連情報を事前に登録(OAuth 2.0)\l- 認証URL\l- クライアントID\l- クライアントシークレット\l- リダイレクトURI\l- アクセストークンURI\l- ...

activate cek
deactivate cek

user ->> app: Extensionを有効にする

activate app
  app ->> cek: URLをリクエストする

  activate cek
    cek - ->> app: 認証URLを返す
  deactivate cek

  app ->> auth: ログインページをリクエストする(認証URL)

  activate auth
    auth - ->> app: ログインページを返す
  deactivate auth

  app -> app: ログインページを表示する
  user ->> app: アカウント認証(ログイン)
  app ->> auth: 認証をリクエストする

  activate auth
  auth - ->> app: Authorization codeをリダイレクトURIと一緒に返す
  deactivate auth

  app ->> cek: Authorization codeを渡す
deactivate app

  activate cek
      cek ->> auth: アクセストークンURIにauthorization codeをパラメータで渡す
      activate auth
        auth - ->> cek: アクセストークンを返す
      deactivate auth

    cek -> cek: ユーザーアカウント情報に\nアクセストークンを保存する
    cek ->> ext: アクセストークンを含めてユーザーのリクエストを渡す
    deactivate cek
    activate ext

@enduml

PlantUML version 1.2018.12(Sun Oct 21 19:15:15 KST 2018)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.8.0_191-b12
Operating System: Windows 10
OS Version: 10.0
Default Encoding: MS949
Language: en
Country: US
--></g></svg>