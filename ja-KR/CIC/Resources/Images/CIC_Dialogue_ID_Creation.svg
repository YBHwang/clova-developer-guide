<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1124px" preserveAspectRatio="none" style="width:689px;height:1124px;" version="1.1" viewBox="0 0 689 1124" width="689px" zoomAndPan="magnify"><defs/><g><rect fill="#FFFFFF" height="381.3418" style="stroke: #FFFFFF; stroke-width: 1.0;" width="10" x="238" y="109.7119"/><line style="stroke: #000000; stroke-width: 1.0;" x1="238" x2="238" y1="109.7119" y2="491.0537"/><line style="stroke: #000000; stroke-width: 1.0;" x1="248" x2="248" y1="109.7119" y2="491.0537"/><line style="stroke: #000000; stroke-width: 1.0;" x1="238" x2="248" y1="109.7119" y2="109.7119"/><rect fill="#FFFFFF" height="548.3066" style="stroke: #FFFFFF; stroke-width: 1.0;" width="10" x="238" y="555.5361"/><line style="stroke: #000000; stroke-width: 1.0;" x1="238" x2="238" y1="555.5361" y2="1103.8428"/><line style="stroke: #000000; stroke-width: 1.0;" x1="248" x2="248" y1="555.5361" y2="1103.8428"/><line style="stroke: #000000; stroke-width: 1.0;" x1="238" x2="248" y1="1103.8428" y2="1103.8428"/><rect fill="#FFFFFF" height="232.377" rx="5" ry="5" style="stroke: #000000; stroke-width: 2.0;" width="506" x="171" y="188.1943"/><rect fill="#FFFFFF" height="105.4473" style="stroke: none; stroke-width: 1.0;" width="506" x="171" y="315.124"/><rect fill="#FFFFFF" height="419.3418" rx="5" ry="5" style="stroke: #000000; stroke-width: 2.0;" width="614" x="63" y="676.501"/><rect fill="#FFFFFF" height="101.9648" style="stroke: none; stroke-width: 1.0;" width="614" x="63" y="993.8779"/><line style="stroke: #000000; stroke-width: 1.0;" x1="55" x2="55" y1="57.2295" y2="491.0537"/><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="55" x2="55" y1="491.0537" y2="555.5361"/><line style="stroke: #000000; stroke-width: 1.0;" x1="55" x2="55" y1="555.5361" y2="1112.8428"/><line style="stroke: #000000; stroke-width: 1.0;" x1="243" x2="243" y1="57.2295" y2="491.0537"/><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="243" x2="243" y1="491.0537" y2="555.5361"/><line style="stroke: #000000; stroke-width: 1.0;" x1="243" x2="243" y1="555.5361" y2="1112.8428"/><line style="stroke: #000000; stroke-width: 1.0;" x1="638" x2="638" y1="57.2295" y2="491.0537"/><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="638" x2="638" y1="491.0537" y2="555.5361"/><line style="stroke: #000000; stroke-width: 1.0;" x1="638" x2="638" y1="555.5361" y2="1112.8428"/><rect fill="#9EA0CA" height="53.2295" rx="5" ry="5" style="stroke: #FFFFFF; stroke-width: 1.5;" width="94" x="8" y="3"/><text fill="#FFFFFF" font-family="&quot;Malgun Gothic&quot;, sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="60" x="25" y="36.1533">ユーザー</text><rect fill="#9EA0CA" height="53.2295" rx="5" ry="5" style="stroke: #FFFFFF; stroke-width: 1.5;" width="124" x="181" y="3"/><text fill="#FFFFFF" font-family="&quot;Malgun Gothic&quot;, sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="90" x="198" y="36.1533">クライアント</text><rect fill="#05D686" height="53.2295" rx="5" ry="5" style="stroke: #FFFFFF; stroke-width: 1.5;" width="58" x="609" y="3"/><text fill="#FFFFFF" font-family="&quot;Malgun Gothic&quot;, sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="24" x="626" y="36.1533">CIC</text><rect fill="#FFFFFF" height="381.3418" style="stroke: #FFFFFF; stroke-width: 1.0;" width="10" x="238" y="109.7119"/><line style="stroke: #000000; stroke-width: 1.0;" x1="238" x2="238" y1="109.7119" y2="491.0537"/><line style="stroke: #000000; stroke-width: 1.0;" x1="248" x2="248" y1="109.7119" y2="491.0537"/><line style="stroke: #000000; stroke-width: 1.0;" x1="238" x2="248" y1="109.7119" y2="109.7119"/><rect fill="#FFFFFF" height="548.3066" style="stroke: #FFFFFF; stroke-width: 1.0;" width="10" x="238" y="555.5361"/><line style="stroke: #000000; stroke-width: 1.0;" x1="238" x2="238" y1="555.5361" y2="1103.8428"/><line style="stroke: #000000; stroke-width: 1.0;" x1="248" x2="248" y1="555.5361" y2="1103.8428"/><line style="stroke: #000000; stroke-width: 1.0;" x1="238" x2="248" y1="1103.8428" y2="1103.8428"/><line style="stroke: #000000; stroke-width: 1.0;" x1="236" x2="226" y1="109.7119" y2="105.7119"/><line style="stroke: #000000; stroke-width: 1.0;" x1="236" x2="226" y1="109.7119" y2="113.7119"/><line style="stroke: #000000; stroke-width: 1.0;" x1="55" x2="237" y1="109.7119" y2="109.7119"/><text fill="#000000" font-family="&quot;Malgun Gothic&quot;, sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="144" x="74.5" y="95.0752">クラシック音楽を再生して</text><line style="stroke: #000000; stroke-width: 1.0;" x1="248" x2="290" y1="160.1943" y2="160.1943"/><line style="stroke: #000000; stroke-width: 1.0;" x1="290" x2="290" y1="160.1943" y2="173.1943"/><line style="stroke: #000000; stroke-width: 1.0;" x1="249" x2="290" y1="173.1943" y2="173.1943"/><polygon fill="#000000" points="259,169.1943,249,173.1943,259,177.1943,255,173.1943" style="stroke: #000000; stroke-width: 1.0;"/><text fill="#000000" font-family="&quot;Malgun Gothic&quot;, sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="147" x="265" y="145.5576">ダイアログID(A)を作成する</text><path d="M176,188.1943 L250,188.1943 L250,216.1943 L240,226.1943 L171,226.1943 L171,193.1943 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="232.377" rx="5" ry="5" style="stroke: #000000; stroke-width: 2.0;" width="506" x="171" y="188.1943"/><text fill="#000000" font-family="&quot;Malgun Gothic&quot;, sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="196" y="213.04">alt</text><text fill="#000000" font-family="&quot;Malgun Gothic&quot;, sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="164" x="275" y="214.04">[音声でリクエストした場合]</text><line style="stroke: #000000; stroke-width: 1.0;" x1="636" x2="626" y1="307.124" y2="303.124"/><line style="stroke: #000000; stroke-width: 1.0;" x1="636" x2="626" y1="307.124" y2="311.124"/><line style="stroke: #000000; stroke-width: 1.0;" x1="248" x2="637" y1="307.124" y2="307.124"/><text fill="#000000" font-family="&quot;Malgun Gothic&quot;, sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="273" x="306.5" y="276.0049">SpeechRecognizer.Recognizeイベントを送信する</text><text fill="#000000" font-family="&quot;Malgun Gothic&quot;, sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="154" x="366" y="292.4873">(header.dialogRequestId: A)</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="171" x2="677" y1="316.124" y2="316.124"/><text fill="#000000" font-family="&quot;Malgun Gothic&quot;, sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="190" x="186" y="339.9697">[テキストでリクエストした場合]</text><line style="stroke: #000000; stroke-width: 1.0;" x1="636" x2="626" y1="412.5713" y2="408.5713"/><line style="stroke: #000000; stroke-width: 1.0;" x1="636" x2="626" y1="412.5713" y2="416.5713"/><line style="stroke: #000000; stroke-width: 1.0;" x1="248" x2="637" y1="412.5713" y2="412.5713"/><text fill="#000000" font-family="&quot;Malgun Gothic&quot;, sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="253" x="316.5" y="381.4521">TextRecognizer.Recognizeイベントを送信する</text><text fill="#000000" font-family="&quot;Malgun Gothic&quot;, sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="154" x="366" y="397.9346">(header.dialogRequestId: A)</text><line style="stroke: #000000; stroke-width: 1.0;" x1="248" x2="290" y1="470.0537" y2="470.0537"/><line style="stroke: #000000; stroke-width: 1.0;" x1="290" x2="290" y1="470.0537" y2="483.0537"/><line style="stroke: #000000; stroke-width: 1.0;" x1="249" x2="290" y1="483.0537" y2="483.0537"/><polygon fill="#000000" points="259,479.0537,249,483.0537,259,487.0537,255,483.0537" style="stroke: #000000; stroke-width: 1.0;"/><text fill="#000000" font-family="&quot;Malgun Gothic&quot;, sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="156" x="265" y="455.417">最終ダイアログIDを更新する</text><path d="M74,439.6978 L74,478.6978 A5,5 0 0 0 79,483.6978 L228,483.6978 A5,5 0 0 0 233,478.6978 L233,444.6978 L223,434.6978 L79,434.6978 A5,5 0 0 0 74,439.6978 " fill="#9EA0CA" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M223,434.6978 L223,442.1978 A2.5,2.5 0 0 0 225.5,444.6978 L233,444.6978 L223,434.6978 " fill="#9EA0CA" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#FFFFFF" font-family="&quot;Malgun Gothic&quot;, sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="118" x="90" y="465.8511">lastDialogueID: A</text><text fill="#000000" font-family="&quot;Malgun Gothic&quot;, sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="108" x="292.5" y="528.8994">リクエストを処理中</text><line style="stroke: #000000; stroke-width: 1.0;" x1="236" x2="226" y1="598.0186" y2="594.0186"/><line style="stroke: #000000; stroke-width: 1.0;" x1="236" x2="226" y1="598.0186" y2="602.0186"/><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="55" x2="237" y1="598.0186" y2="598.0186"/><text fill="#000000" font-family="&quot;Malgun Gothic&quot;, sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="96" x="98.5" y="583.3818">今の天気を教えて</text><line style="stroke: #000000; stroke-width: 1.0;" x1="248" x2="290" y1="648.501" y2="648.501"/><line style="stroke: #000000; stroke-width: 1.0;" x1="290" x2="290" y1="648.501" y2="661.501"/><line style="stroke: #000000; stroke-width: 1.0;" x1="249" x2="290" y1="661.501" y2="661.501"/><polygon fill="#000000" points="259,657.501,249,661.501,259,665.501,255,661.501" style="stroke: #000000; stroke-width: 1.0;"/><text fill="#000000" font-family="&quot;Malgun Gothic&quot;, sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="148" x="265" y="633.8643">ダイアログID(B)を作成する</text><path d="M68,676.501 L142,676.501 L142,704.501 L132,714.501 L63,714.501 L63,681.501 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="419.3418" rx="5" ry="5" style="stroke: #000000; stroke-width: 2.0;" width="614" x="63" y="676.501"/><text fill="#000000" font-family="&quot;Malgun Gothic&quot;, sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="88" y="701.3467">alt</text><text fill="#000000" font-family="&quot;Malgun Gothic&quot;, sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="164" x="167" y="702.3467">[作業を正常に処理する場合]</text><line style="stroke: #000000; stroke-width: 1.0;" x1="636" x2="626" y1="795.4307" y2="791.4307"/><line style="stroke: #000000; stroke-width: 1.0;" x1="636" x2="626" y1="795.4307" y2="799.4307"/><line style="stroke: #000000; stroke-width: 1.0;" x1="248" x2="637" y1="795.4307" y2="795.4307"/><text fill="#000000" font-family="&quot;Malgun Gothic&quot;, sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="273" x="306.5" y="764.3115">SpeechRecognizer.Recognizeイベントを送信する</text><text fill="#000000" font-family="&quot;Malgun Gothic&quot;, sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="155" x="365.5" y="780.7939">(header.dialogRequestId: B)</text><line style="stroke: #000000; stroke-width: 1.0;" x1="248" x2="290" y1="845.9131" y2="845.9131"/><line style="stroke: #000000; stroke-width: 1.0;" x1="290" x2="290" y1="845.9131" y2="858.9131"/><line style="stroke: #000000; stroke-width: 1.0;" x1="249" x2="290" y1="858.9131" y2="858.9131"/><polygon fill="#000000" points="259,854.9131,249,858.9131,259,862.9131,255,858.9131" style="stroke: #000000; stroke-width: 1.0;"/><text fill="#000000" font-family="&quot;Malgun Gothic&quot;, sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="156" x="265" y="831.2764">最終ダイアログIDを更新する</text><path d="M73,815.5571 L73,854.5571 A5,5 0 0 0 78,859.5571 L228,859.5571 A5,5 0 0 0 233,854.5571 L233,820.5571 L223,810.5571 L78,810.5571 A5,5 0 0 0 73,815.5571 " fill="#9EA0CA" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M223,810.5571 L223,818.0571 A2.5,2.5 0 0 0 225.5,820.5571 L233,820.5571 L223,810.5571 " fill="#9EA0CA" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#FFFFFF" font-family="&quot;Malgun Gothic&quot;, sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="119" x="89" y="841.7104">lastDialogueID: B</text><line style="stroke: #000000; stroke-width: 1.0;" x1="248" x2="290" y1="909.3955" y2="909.3955"/><line style="stroke: #000000; stroke-width: 1.0;" x1="290" x2="290" y1="909.3955" y2="922.3955"/><line style="stroke: #000000; stroke-width: 1.0;" x1="249" x2="290" y1="922.3955" y2="922.3955"/><polygon fill="#000000" points="259,918.3955,249,922.3955,259,926.3955,255,922.3955" style="stroke: #000000; stroke-width: 1.0;"/><text fill="#000000" font-family="&quot;Malgun Gothic&quot;, sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="291" x="265" y="894.7588">前のダイアログID(A)に関連する作業の処理を中止する</text><line style="stroke: #000000; stroke-width: 1.0;" x1="248" x2="290" y1="972.8779" y2="972.8779"/><line style="stroke: #000000; stroke-width: 1.0;" x1="290" x2="290" y1="972.8779" y2="985.8779"/><line style="stroke: #000000; stroke-width: 1.0;" x1="249" x2="290" y1="985.8779" y2="985.8779"/><polygon fill="#000000" points="259,981.8779,249,985.8779,259,989.8779,255,985.8779" style="stroke: #000000; stroke-width: 1.0;"/><text fill="#000000" font-family="&quot;Malgun Gothic&quot;, sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="351" x="265" y="958.2412">ダイアログID(A)に関連するディレクティブをキューから破棄する</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="63" x2="677" y1="994.8779" y2="994.8779"/><text fill="#000000" font-family="&quot;Malgun Gothic&quot;, sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="320" x="78" y="1018.7236">[例外が発生してイベントの送信をキャンセルする場合]</text><line style="stroke: #000000; stroke-width: 1.0;" x1="248" x2="290" y1="1074.8428" y2="1074.8428"/><line style="stroke: #000000; stroke-width: 1.0;" x1="290" x2="290" y1="1074.8428" y2="1087.8428"/><line style="stroke: #000000; stroke-width: 1.0;" x1="249" x2="290" y1="1087.8428" y2="1087.8428"/><polygon fill="#000000" points="259,1083.8428,249,1087.8428,259,1091.8428,255,1087.8428" style="stroke: #000000; stroke-width: 1.0;"/><text fill="#000000" font-family="&quot;Malgun Gothic&quot;, sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="303" x="265" y="1060.2061">前のダイアログID(A)に関連する作業を引き続き処理する</text><path d="M74,1044.4868 L74,1083.4868 A5,5 0 0 0 79,1088.4868 L228,1088.4868 A5,5 0 0 0 233,1083.4868 L233,1049.4868 L223,1039.4868 L79,1039.4868 A5,5 0 0 0 74,1044.4868 " fill="#9EA0CA" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M223,1039.4868 L223,1046.9868 A2.5,2.5 0 0 0 225.5,1049.4868 L233,1049.4868 L223,1039.4868 " fill="#9EA0CA" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#FFFFFF" font-family="&quot;Malgun Gothic&quot;, sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="118" x="90" y="1070.6401">lastDialogueID: A</text><!--
@startuml
scale max 880 width
skinparam sequenceMessageAlign center
skinparam shadowing false
skinparam roundcorner 10
skinparam padding 10
skinparam defaultFontSize 12
skinparam defaultFontName "Malgun Gothic", sans-serif

skinparam note {
  BackgroundColor #9EA0CA
  BorderColor #ffffff
  FontColor #ffffff
  FontSize 14
  FontStyle bold
}

skinparam sequence {
  ArrowColor #000000
  ActorBorderColor #000000
  ActorFontStyle Bolder


  LifeLineBorderColor #000000
  LifeLineBackgroundColor transparent
  ParticipantBorderColor transparent
  ParticipantFontSize 14
  ParticipantFontColor #ffffff
  ParticipantFontStyle bold

  BoxBorderColor #000000
  BoxFontColor #ffffff
    BoxFontSize 14
    BoxFontStyle bold
}
hide footbox

skinparam activity {
  BackgroundColor #9EA0CA
  BarColor #ffffff
  BorderColor #ffffff
  DiamondBackgroundColor #05D686
  DiamondBorderColor #ffffff
  DiamondFontColor #ffffff
  DiamondFontSize 14
  DiamondFontStyle bold
  FontColor #ffffff 
  FontSize 14
  FontStyle bold
}

participant ユーザー as user #9EA0CA
participant クライアント as client #9EA0CA
participant CIC as cic #05D686

user ->> client: クラシック音楽を再生して

activate client

  client -> client: ダイアログID(A)を作成する

  alt 音声でリクエストした場合

    client ->> cic: SpeechRecognizer.Recognizeイベントを送信する\n(header.dialogRequestId: A)

  else テキストでリクエストした場合

    client ->> cic: TextRecognizer.Recognizeイベントを送信する\n(header.dialogRequestId: A)

  end

  client -> client: 最終ダイアログIDを更新する
  
  note left: lastDialogueID: A

  ... リクエストを処理中 ...

user - ->> client: 今の天気を教えて

  client -> client: ダイアログID(B)を作成する

  alt 作業を正常に処理する場合

    client ->> cic: SpeechRecognizer.Recognizeイベントを送信する\n(header.dialogRequestId: B)

    client -> client: 最終ダイアログIDを更新する
  
    note left: lastDialogueID: B

    client -> client: 前のダイアログID(A)に関連する作業の処理を中止する

    client -> client: ダイアログID(A)に関連するディレクティブをキューから破棄する

  else 例外が発生してイベントの送信をキャンセルする場合

    client -> client: 前のダイアログID(A)に関連する作業を引き続き処理する

    note left: lastDialogueID: A

  end

@enduml

PlantUML version 1.2018.12(Sun Oct 21 19:15:15 KST 2018)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.8.0_191-b12
Operating System: Windows 10
OS Version: 10.0
Default Encoding: MS949
Language: en
Country: US
--></g></svg>