
<!DOCTYPE HTML>
<html lang="en" >
    <head>
        <title>Clova Developer Guide</title>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="This documentation provides developer guides as well as API references for CIC and CEK platforms provided by Clova.">
        <meta name="generator" content="GitBook 3.2.3">
        <meta name="author" content="LINE Corp.">
        
        
    
    <link rel="stylesheet" href="../../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-page-toc-button/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
        <link rel="stylesheet" href="../../styles/website.css">
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="Interact_with_CIC.html" />
    
    
    <link rel="prev" href="../CIC_Overview.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        <li class="header">About This Document</li>
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../">
            
                <a href="../../">
            
                    
                    Documentation summary
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../../Copyright.html">
            
                <a href="../../Copyright.html">
            
                    
                    Copyright
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../../Terms.html">
            
                <a href="../../Terms.html">
            
                    
                    Terms and abbreviations
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Clova Interface Connect</li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="../CIC_Overview.html">
            
                <a href="../CIC_Overview.html">
            
                    
                    CIC overview
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.1" data-path="../CIC_Overview.html">
            
                <a href="../CIC_Overview.html#WhatisCIC">
            
                    
                    What is CIC?
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.2" data-path="../CIC_Overview.html">
            
                <a href="../CIC_Overview.html#CICInteractionStructure">
            
                    
                    CIC interaction structure
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3" data-path="../CIC_Overview.html">
            
                <a href="../CIC_Overview.html#DialogModel">
            
                    
                    Dialog model
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter active" data-level="2.2" data-path="Interact_with_CIC.html">
            
                <a href="Interact_with_CIC.html">
            
                    
                    Interacting with CIC
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.2.1" data-path="Interact_with_CIC.html">
            
                <a href="Interact_with_CIC.html#Preparation">
            
                    
                    Preparation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.2" data-path="Interact_with_CIC.html">
            
                <a href="Interact_with_CIC.html#ConnectToCIC">
            
                    
                    Connecting with CIC
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.2.2.1" data-path="Interact_with_CIC.html">
            
                <a href="Interact_with_CIC.html#CreateClovaAccessToken">
            
                    
                    Creating Clova access token
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.2.2" data-path="Interact_with_CIC.html">
            
                <a href="Interact_with_CIC.html#CreateConnection">
            
                    
                    Creating connection
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.2.3" data-path="Interact_with_CIC.html">
            
                <a href="Interact_with_CIC.html#Authorization">
            
                    
                    Getting authorization
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.2.4" data-path="Interact_with_CIC.html">
            
                <a href="Interact_with_CIC.html#ManageConnection">
            
                    
                    Managing connection
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.2.3" data-path="Interact_with_CIC.html">
            
                <a href="Interact_with_CIC.html#SendEvent">
            
                    
                    Sending event message
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.4" data-path="Interact_with_CIC.html">
            
                <a href="Interact_with_CIC.html#HandleDirective">
            
                    
                    Handling directive message
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.5" data-path="Interact_with_CIC.html">
            
                <a href="Interact_with_CIC.html#ManageMessageQ">
            
                    
                    Managing message queue
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="../References/CIC_API.html">
            
                <a href="../References/CIC_API.html">
            
                    
                    CIC API reference
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.3.1" data-path="../References/CIC_API.html">
            
                <a href="../References/CIC_API.html#BasicInfo">
            
                    
                    API basics
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.3.1.1" data-path="../References/CIC_API.html">
            
                <a href="../References/CIC_API.html#BaseURL">
            
                    
                    Base URL
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.1.2" data-path="../References/CIC_API.html">
            
                <a href="../References/CIC_API.html#MultipartMessage">
            
                    
                    Multipart
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.3.2" data-path="../References/CIC_API.html">
            
                <a href="../References/CIC_API.html#EstablishDownchannel">
            
                    
                    Establishing downchannel
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.3" data-path="../References/CIC_API.html">
            
                <a href="../References/CIC_API.html#SendEvent">
            
                    
                    Sending event message
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.4" data-path="../References/CIC_API.html">
            
                <a href="../References/CIC_API.html#CICMessageFormat">
            
                    
                    Message format
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.3.4.1" data-path="../References/CIC_API.html">
            
                <a href="../References/CIC_API.html#Event">
            
                    
                    Event message
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.4.2" data-path="../References/CIC_API.html">
            
                <a href="../References/CIC_API.html#Directive">
            
                    
                    Directive message
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.4.3" data-path="../References/CIC_API.html">
            
                <a href="../References/CIC_API.html#Error">
            
                    
                    Error message
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.3.5" data-path="../References/CIC_API.html">
            
                <a href="../References/CIC_API.html#CICInterface">
            
                    
                    Interface
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.3.5.1" data-path="../References/CICInterface/Alerts.html">
            
                <a href="../References/CICInterface/Alerts.html">
            
                    
                    Alerts
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.5.2" data-path="../References/CICInterface/AudioPlayer.html">
            
                <a href="../References/CICInterface/AudioPlayer.html">
            
                    
                    AudioPlayer
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.5.3" data-path="../References/CICInterface/Clova.html">
            
                <a href="../References/CICInterface/Clova.html">
            
                    
                    Clova
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.5.4" data-path="../References/CICInterface/DeviceControl.html">
            
                <a href="../References/CICInterface/DeviceControl.html">
            
                    
                    DeviceControl
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.5.5" data-path="../References/CICInterface/Notifier.html">
            
                <a href="../References/CICInterface/Notifier.html">
            
                    
                    Notifier
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.5.6" data-path="../References/CICInterface/PlaybackController.html">
            
                <a href="../References/CICInterface/PlaybackController.html">
            
                    
                    PlaybackController
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.5.7" data-path="../References/CICInterface/SpeechRecognizer.html">
            
                <a href="../References/CICInterface/SpeechRecognizer.html">
            
                    
                    SpeechRecognizer
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.5.8" data-path="../References/CICInterface/SpeechSynthesizer.html">
            
                <a href="../References/CICInterface/SpeechSynthesizer.html">
            
                    
                    SpeechSynthesizer
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.5.9" data-path="../References/CICInterface/System.html">
            
                <a href="../References/CICInterface/System.html">
            
                    
                    System
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.5.10" data-path="../References/CICInterface/TextRecognizer.html">
            
                <a href="../References/CICInterface/TextRecognizer.html">
            
                    
                    TextRecognizer
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.5.11" data-path="../References/CICInterface/Index_for_Events.html">
            
                <a href="../References/CICInterface/Index_for_Events.html">
            
                    
                    Event messages index
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.5.12" data-path="../References/CICInterface/Index_for_Directives.html">
            
                <a href="../References/CICInterface/Index_for_Directives.html">
            
                    
                    Directive messages index
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.3.6" data-path="../References/Context_Objects.html">
            
                <a href="../References/Context_Objects.html">
            
                    
                    Context information
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.3.6.1" data-path="../References/Context_Objects.html">
            
                <a href="../References/Context_Objects.html#AlertsState">
            
                    
                    Alert.AlertsState
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.6.2" data-path="../References/Context_Objects.html">
            
                <a href="../References/Context_Objects.html#PlaybackState">
            
                    
                    AudioPlayer.PlaybackState
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.6.3" data-path="../References/Context_Objects.html">
            
                <a href="../References/Context_Objects.html#FreetalkState">
            
                    
                    Clova.FreetalkState
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.6.4" data-path="../References/Context_Objects.html">
            
                <a href="../References/Context_Objects.html#Location">
            
                    
                    Clova.Location
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.6.5" data-path="../References/Context_Objects.html">
            
                <a href="../References/Context_Objects.html#SavedPlace">
            
                    
                    Clova.SavedPlace
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.6.6" data-path="../References/Context_Objects.html">
            
                <a href="../References/Context_Objects.html#DeviceState">
            
                    
                    Device.DeviceState
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.6.7" data-path="../References/Context_Objects.html">
            
                <a href="../References/Context_Objects.html#Display">
            
                    
                    Device.Display
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.6.8" data-path="../References/Context_Objects.html">
            
                <a href="../References/Context_Objects.html#VolumeState">
            
                    
                    Speaker.VolumeState
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="../References/Content_Templates.html">
            
                <a href="../References/Content_Templates.html">
            
                    
                    Content template reference
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.4.1" data-path="../References/ContentTemplates/ActionTimer.html">
            
                <a href="../References/ContentTemplates/ActionTimer.html">
            
                    
                    ActionTimer
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4.2" data-path="../References/ContentTemplates/ActionTimerList.html">
            
                <a href="../References/ContentTemplates/ActionTimerList.html">
            
                    
                    ActionTimerList
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4.3" data-path="../References/ContentTemplates/Alarm.html">
            
                <a href="../References/ContentTemplates/Alarm.html">
            
                    
                    Alarm
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4.4" data-path="../References/ContentTemplates/AlarmList.html">
            
                <a href="../References/ContentTemplates/AlarmList.html">
            
                    
                    AlarmList
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4.5" data-path="../References/ContentTemplates/Atmosphere.html">
            
                <a href="../References/ContentTemplates/Atmosphere.html">
            
                    
                    Atmosphere
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4.6" data-path="../References/ContentTemplates/CardList.html">
            
                <a href="../References/ContentTemplates/CardList.html">
            
                    
                    CardList
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4.7" data-path="../References/ContentTemplates/CarRoute.html">
            
                <a href="../References/ContentTemplates/CarRoute.html">
            
                    
                    CarRoute
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4.8" data-path="../References/ContentTemplates/Humidity.html">
            
                <a href="../References/ContentTemplates/Humidity.html">
            
                    
                    Humidity
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4.9" data-path="../References/ContentTemplates/ImageList.html">
            
                <a href="../References/ContentTemplates/ImageList.html">
            
                    
                    ImageList
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4.10" data-path="../References/ContentTemplates/ImageText.html">
            
                <a href="../References/ContentTemplates/ImageText.html">
            
                    
                    ImageText
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4.11" data-path="../References/ContentTemplates/Memo.html">
            
                <a href="../References/ContentTemplates/Memo.html">
            
                    
                    Memo
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4.12" data-path="../References/ContentTemplates/MemoList.html">
            
                <a href="../References/ContentTemplates/MemoList.html">
            
                    
                    MemoList
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4.13" data-path="../References/ContentTemplates/Popup.html">
            
                <a href="../References/ContentTemplates/Popup.html">
            
                    
                    Popup
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4.14" data-path="../References/ContentTemplates/Reminder.html">
            
                <a href="../References/ContentTemplates/Reminder.html">
            
                    
                    Reminder
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4.15" data-path="../References/ContentTemplates/ReminderList.html">
            
                <a href="../References/ContentTemplates/ReminderList.html">
            
                    
                    ReminderList
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4.16" data-path="../References/ContentTemplates/Schedule.html">
            
                <a href="../References/ContentTemplates/Schedule.html">
            
                    
                    Schedule
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4.17" data-path="../References/ContentTemplates/ScheduleList.html">
            
                <a href="../References/ContentTemplates/ScheduleList.html">
            
                    
                    ScheduleList
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4.18" data-path="../References/ContentTemplates/Text.html">
            
                <a href="../References/ContentTemplates/Text.html">
            
                    
                    Text
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4.19" data-path="../References/ContentTemplates/Timer.html">
            
                <a href="../References/ContentTemplates/Timer.html">
            
                    
                    Timer
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4.20" data-path="../References/ContentTemplates/TimerList.html">
            
                <a href="../References/ContentTemplates/TimerList.html">
            
                    
                    TimerList
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4.21" data-path="../References/ContentTemplates/TodayWeather.html">
            
                <a href="../References/ContentTemplates/TodayWeather.html">
            
                    
                    TodayWeather
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4.22" data-path="../References/ContentTemplates/TomorrowWeather.html">
            
                <a href="../References/ContentTemplates/TomorrowWeather.html">
            
                    
                    TomorrowWeather
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4.23" data-path="../References/ContentTemplates/TransportationRoute.html">
            
                <a href="../References/ContentTemplates/TransportationRoute.html">
            
                    
                    TransportationRoute
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4.24" data-path="../References/ContentTemplates/WeeklyWeather.html">
            
                <a href="../References/ContentTemplates/WeeklyWeather.html">
            
                    
                    WeeklyWeather
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4.25" data-path="../References/ContentTemplates/WindSpeed.html">
            
                <a href="../References/ContentTemplates/WindSpeed.html">
            
                    
                    WindSpeed
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4.26" data-path="../References/ContentTemplates/Common_Fields.html">
            
                <a href="../References/ContentTemplates/Common_Fields.html">
            
                    
                    Common fields
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4.27" data-path="../References/ContentTemplates/Shared_Objects.html">
            
                <a href="../References/ContentTemplates/Shared_Objects.html">
            
                    
                    Shared objects
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.5" data-path="../References/Clova_Auth_API.html">
            
                <a href="../References/Clova_Auth_API.html">
            
                    
                    Clova Auth API reference
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.5.1" data-path="../References/Clova_Auth_API.html">
            
                <a href="../References/Clova_Auth_API.html#RequestAuthorizationCode">
            
                    
                    Requesting authorization code
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.5.2" data-path="../References/Clova_Auth_API.html">
            
                <a href="../References/Clova_Auth_API.html#RequestClovaAccessToken">
            
                    
                    Requesting Clova access token
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.5.3" data-path="../References/Clova_Auth_API.html">
            
                <a href="../References/Clova_Auth_API.html#RefreshClovaAccessToken">
            
                    
                    Refreshing Clova access token
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.5.4" data-path="../References/Clova_Auth_API.html">
            
                <a href="../References/Clova_Auth_API.html#DeleteClovaAccessToken">
            
                    
                    Deleting Clova access token
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">Clova Extensions Kit</li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="../../CEK/CEK_Overview.html">
            
                <a href="../../CEK/CEK_Overview.html">
            
                    
                    CEK overview
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1.1" data-path="../../CEK/CEK_Overview.html">
            
                <a href="../../CEK/CEK_Overview.html#WhatisCEK">
            
                    
                    What is CEK?
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.2" data-path="../../CEK/CEK_Overview.html">
            
                <a href="../../CEK/CEK_Overview.html#CEKInteractionStructure">
            
                    
                    CEK interaction structure
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.3" data-path="../../CEK/CEK_Overview.html">
            
                <a href="../../CEK/CEK_Overview.html#ExtensionType">
            
                    
                    Extension type
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="../../CEK/Guides/Build_Custom_Extension.html">
            
                <a href="../../CEK/Guides/Build_Custom_Extension.html">
            
                    
                    Building custom extension
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.2.1" data-path="../../CEK/Guides/Build_Custom_Extension.html">
            
                <a href="../../CEK/Guides/Build_Custom_Extension.html#Preparation">
            
                    
                    Preparation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2.2" data-path="../../CEK/Guides/Build_Custom_Extension.html">
            
                <a href="../../CEK/Guides/Build_Custom_Extension.html#HandleCustomExtensionRequest">
            
                    
                    Handling custom extension request
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.2.2.1" data-path="../../CEK/Guides/Build_Custom_Extension.html">
            
                <a href="../../CEK/Guides/Build_Custom_Extension.html#HandleLaunchRequest">
            
                    
                    Handling LaunchRequest
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2.2.2" data-path="../../CEK/Guides/Build_Custom_Extension.html">
            
                <a href="../../CEK/Guides/Build_Custom_Extension.html#HandleIntentRequest">
            
                    
                    Handling IntentRequest
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2.2.3" data-path="../../CEK/Guides/Build_Custom_Extension.html">
            
                <a href="../../CEK/Guides/Build_Custom_Extension.html#HandleSessionEndedRequest">
            
                    
                    Handling SessionEndedRequest
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.2.3" data-path="../../CEK/Guides/Build_Custom_Extension.html">
            
                <a href="../../CEK/Guides/Build_Custom_Extension.html#ReturnCustomExtensionResponse">
            
                    
                    Returning custom extension response
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2.4" data-path="../../CEK/Guides/Build_Custom_Extension.html">
            
                <a href="../../CEK/Guides/Build_Custom_Extension.html#DoMultiturnDialog">
            
                    
                    Having multi-turn dialog
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="../../CEK/Guides/Build_Clova_Home_Extension.html">
            
                <a href="../../CEK/Guides/Build_Clova_Home_Extension.html">
            
                    
                    Building Clova Home extension
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.3.1" data-path="../../CEK/Guides/Build_Clova_Home_Extension.html">
            
                <a href="../../CEK/Guides/Build_Clova_Home_Extension.html#Preparation">
            
                    
                    Preparation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.3.2" data-path="../../CEK/Guides/Build_Clova_Home_Extension.html">
            
                <a href="../../CEK/Guides/Build_Clova_Home_Extension.html#ProvideDeviceDiscovery">
            
                    
                    Providing device discovery
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.3.3" data-path="../../CEK/Guides/Build_Clova_Home_Extension.html">
            
                <a href="../../CEK/Guides/Build_Clova_Home_Extension.html#HandleClovaHomeExtensionRequest">
            
                    
                    Handling Clova Home extension request
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.3.4" data-path="../../CEK/Guides/Build_Clova_Home_Extension.html">
            
                <a href="../../CEK/Guides/Build_Clova_Home_Extension.html#ReturnClovaHomeExtensionResponse">
            
                    
                    Returning Clova Home extension response
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.4" data-path="../../CEK/Guides/LinkUserAccount.html">
            
                <a href="../../CEK/Guides/LinkUserAccount.html">
            
                    
                    Linking user account
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.4.1" data-path="../../CEK/Guides/LinkUserAccount.html">
            
                <a href="../../CEK/Guides/LinkUserAccount.html#UnderstandAccountLinking">
            
                    
                    Understanding account linking
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.4.1.1" data-path="../../CEK/Guides/LinkUserAccount.html">
            
                <a href="../../CEK/Guides/LinkUserAccount.html#SetupAccountLinking">
            
                    
                    Configuring account linking
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.4.1.2" data-path="../../CEK/Guides/LinkUserAccount.html">
            
                <a href="../../CEK/Guides/LinkUserAccount.html#ExtensionInvokingAfterAccountLinking">
            
                    
                    Invoking extension after account is linked
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.4.2" data-path="../../CEK/Guides/LinkUserAccount.html">
            
                <a href="../../CEK/Guides/LinkUserAccount.html#ApplyAccountLinking">
            
                    
                    Applying account linking
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.4.2.1" data-path="../../CEK/Guides/LinkUserAccount.html">
            
                <a href="../../CEK/Guides/LinkUserAccount.html#BuildAuthServer">
            
                    
                    Building authorization server
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.4.2.2" data-path="../../CEK/Guides/LinkUserAccount.html">
            
                <a href="../../CEK/Guides/LinkUserAccount.html#AddValidationLogic">
            
                    
                    Validating account access permission
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.4.2.3" data-path="../../CEK/Guides/LinkUserAccount.html">
            
                <a href="../../CEK/Guides/LinkUserAccount.html#RegisterAccountLinkingInfo">
            
                    
                    Registering account linking information
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.5" data-path="../../CEK/References/CEK_API.html">
            
                <a href="../../CEK/References/CEK_API.html">
            
                    
                    CEK API reference
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.5.1" data-path="../../CEK/References/CEK_API.html">
            
                <a href="../../CEK/References/CEK_API.html#HTTPMessage">
            
                    
                    HTTP message
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.5.2" data-path="../../CEK/References/CEK_API.html">
            
                <a href="../../CEK/References/CEK_API.html#CustomExtMessage">
            
                    
                    Custom extension message
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.5.2.1" data-path="../../CEK/References/CEK_API.html">
            
                <a href="../../CEK/References/CEK_API.html#CustomExtRequestMessage">
            
                    
                    Request message
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.5.2.2" data-path="../../CEK/References/CEK_API.html">
            
                <a href="../../CEK/References/CEK_API.html#CustomExtRequestType">
            
                    
                    Request type
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.5.2.3" data-path="../../CEK/References/CEK_API.html">
            
                <a href="../../CEK/References/CEK_API.html#CustomExtResponseMessage">
            
                    
                    Response message
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.5.3" data-path="../../CEK/References/CEK_API.html">
            
                <a href="../../CEK/References/CEK_API.html#ClovaHomeExtMessage">
            
                    
                    Clova Home extension message
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.5.3.1" data-path="../../CEK/References/CEK_API.html">
            
                <a href="../../CEK/References/CEK_API.html#ClovaHomeExtMessageFormat">
            
                    
                    Message format
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.5.3.2" data-path="../../CEK/References/CEK_API.html">
            
                <a href="../../CEK/References/CEK_API.html#ClovaHomeExtInterface">
            
                    
                    Interface
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.5.3.2.1" data-path="../../CEK/References/ClovaHomeInterface/Control_Interfaces.html">
            
                <a href="../../CEK/References/ClovaHomeInterface/Control_Interfaces.html">
            
                    
                    Control
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.5.3.2.2" data-path="../../CEK/References/ClovaHomeInterface/Discovery_Interfaces.html">
            
                <a href="../../CEK/References/ClovaHomeInterface/Discovery_Interfaces.html">
            
                    
                    Discovery
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.5.3.2.3" data-path="../../CEK/References/ClovaHomeInterface/Error_Interfaces.html">
            
                <a href="../../CEK/References/ClovaHomeInterface/Error_Interfaces.html">
            
                    
                    Error
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.5.3.2.4" data-path="../../CEK/References/ClovaHomeInterface/Shared_Objects.html">
            
                <a href="../../CEK/References/ClovaHomeInterface/Shared_Objects.html">
            
                    
                    Shared objects
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">Clova Developer Console</li>
        
        
    
        <li class="chapter " data-level="4.1" data-path="../../DevConsole/ClovaDevConsole_Overview.html">
            
                <a href="../../DevConsole/ClovaDevConsole_Overview.html">
            
                    
                    Clova developer console overview
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2" >
            
                <span>
            
                    
                    Using CIC menu (to be available in the future)
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="4.3" data-path="../../DevConsole/Guides/CEK/Using_CEK_Menu.html">
            
                <a href="../../DevConsole/Guides/CEK/Using_CEK_Menu.html">
            
                    
                    Using CEK Menu
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.3.1" data-path="../../DevConsole/Guides/CEK/Register_Extension.html">
            
                <a href="../../DevConsole/Guides/CEK/Register_Extension.html">
            
                    
                    Registering Extensions
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.3.1.1" data-path="../../DevConsole/Guides/CEK/Register_Extension.html">
            
                <a href="../../DevConsole/Guides/CEK/Register_Extension.html#InputExtensionInfo">
            
                    
                    Enter basic information of your extensions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.1.2" data-path="../../DevConsole/Guides/CEK/Register_Extension.html">
            
                <a href="../../DevConsole/Guides/CEK/Register_Extension.html#SetServerConnection">
            
                    
                    Server configuration
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.3.1.2.1" data-path="../../DevConsole/Guides/CEK/Register_Extension.html">
            
                <a href="../../DevConsole/Guides/CEK/Register_Extension.html#SetAccountLinkning">
            
                    
                    Configure account linking
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.3.2" data-path="../../DevConsole/Guides/CEK/Define_Interaction_Model.html">
            
                <a href="../../DevConsole/Guides/CEK/Define_Interaction_Model.html">
            
                    
                    Defining interaction model
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.3.2.1" data-path="../../DevConsole/Guides/CEK/Define_Interaction_Model.html">
            
                <a href="../../DevConsole/Guides/CEK/Define_Interaction_Model.html#UnderstandInteractionModel">
            
                    
                    Understanding the interaction model
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.3.2.1.1" data-path="../../DevConsole/Guides/CEK/Define_Interaction_Model.html">
            
                <a href="../../DevConsole/Guides/CEK/Define_Interaction_Model.html#Intent">
            
                    
                    Intent
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.2.1.2" data-path="../../DevConsole/Guides/CEK/Define_Interaction_Model.html">
            
                <a href="../../DevConsole/Guides/CEK/Define_Interaction_Model.html#Slot">
            
                    
                    Slot
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.2.1.3" data-path="../../DevConsole/Guides/CEK/Define_Interaction_Model.html">
            
                <a href="../../DevConsole/Guides/CEK/Define_Interaction_Model.html#UtteranceExample">
            
                    
                    User speech example
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.3.2.2" data-path="../../DevConsole/Guides/CEK/Define_Interaction_Model.html">
            
                <a href="../../DevConsole/Guides/CEK/Define_Interaction_Model.html#AddBuiltinSlotType">
            
                    
                    Adding a built-in slot type
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.2.3" data-path="../../DevConsole/Guides/CEK/Define_Interaction_Model.html">
            
                <a href="../../DevConsole/Guides/CEK/Define_Interaction_Model.html#AddCustomSlotType">
            
                    
                    Adding a custom slot type
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.2.4" data-path="../../DevConsole/Guides/CEK/Define_Interaction_Model.html">
            
                <a href="../../DevConsole/Guides/CEK/Define_Interaction_Model.html#AddBuiltinIntent">
            
                    
                    Adding a built-in intent
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.2.5" data-path="../../DevConsole/Guides/CEK/Define_Interaction_Model.html">
            
                <a href="../../DevConsole/Guides/CEK/Define_Interaction_Model.html#AddCustomIntent">
            
                    
                    Adding a custom intent
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.3.3" data-path="../../DevConsole/Guides/CEK/Deploy_Extension.html">
            
                <a href="../../DevConsole/Guides/CEK/Deploy_Extension.html">
            
                    
                    Deploying extensions
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.3.3.1" data-path="../../DevConsole/Guides/CEK/Deploy_Extension.html">
            
                <a href="../../DevConsole/Guides/CEK/Deploy_Extension.html#BuildInteractionModel">
            
                    
                    Building interaction model
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.3.2" data-path="../../DevConsole/Guides/CEK/Deploy_Extension.html">
            
                <a href="../../DevConsole/Guides/CEK/Deploy_Extension.html#TestInteractionModel">
            
                    
                    Testing interaction model
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.3.3" data-path="../../DevConsole/Guides/CEK/Deploy_Extension.html">
            
                <a href="../../DevConsole/Guides/CEK/Deploy_Extension.html#InputDeploymentInfo">
            
                    
                    Entering deployment information
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.3.4" data-path="../../DevConsole/Guides/CEK/Deploy_Extension.html">
            
                <a href="../../DevConsole/Guides/CEK/Deploy_Extension.html#InputComplianceInfo">
            
                    
                    Entering personal information and compliance to regulation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.3.5" data-path="../../DevConsole/Guides/CEK/Deploy_Extension.html">
            
                <a href="../../DevConsole/Guides/CEK/Deploy_Extension.html#RequestExtensionSubmission">
            
                    
                    Requesting extension approval
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../.." >Interacting with CIC</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
                                <section class="normal markdown-section">
                                
                                <h1 id="interacting-with-cic">Interacting with CIC</h1>
<p>To provide Clova services for users, you must make your client (app or device) use the CIC interface to send user requests and contextual information to Clova. First, you need to understand how to connect your client with CIC, which messages are sent and received, and which actions are performed during the process.</p>
<p>This documentation covers the following topics to provide essential information for client development.</p>
<ol>
<li><a href="#Preparation">Preparation</a></li>
<li><a href="#ConnectToCIC">Connecting with CIC</a></li>
<li><a href="#SendEvent">Sending event message</a></li>
<li><a href="#HandleDirective">Handling directive message</a></li>
<li><a href="#ManageMessageQ">Managing message queue</a></li>
</ol>
<h2 id="Preparation">Preparation </h2>
<p>Connect your client with CIC using the HTTP/2 protocol. To do so, prepare the following.</p>
<ul>
<li><a href="#RequiredLibrary">Libraries</a> for HTTP/2 protocol connection</li>
<li><a href="#ClientAuthInfo">Client credentials</a> for creation of Clova access tokens</li>
</ul>
<h3 id="RequiredLibrary">Required library </h3>
<p>To enable communications over the HTTP/2 protocol, use the libraries recommended below.</p>
<table>
<thead>
<tr>
<th>Programming language</th>
<th>Library</th>
</tr>
</thead>
<tbody>
<tr>
<td>C/C++</td>
<td><a href="https://nghttp2.org/" target="_blank">nghttp2</a>, <a href="https://curl.haxx.se/libcurl/" target="_blank">libcurl</a></td>
</tr>
<tr>
<td>Java</td>
<td><a href="http://square.github.io/okhttp/" target="_blank">OkHttp</a>, <a href="http://netty.io/" target="_blank">Netty</a>, <a href="http://www.eclipse.org/jetty/" target="_blank">Jetty</a></td>
</tr>
</tbody>
</table>
<h3 id="ClientAuthInfo">Client credentials </h3>
<p>To use any services provided by Clova, users must authenticate their LINE account on your client. By using the LINE account information entered by a user, you can obtain an access token for the user&apos;s LINE account. Then, you send the token to a Clova authorization server and <a href="#CreateClovaAccessToken">obtain a Clova access token</a>.</p>
<p>When sending a LINE account access token to an authorization server, make sure to send client credentials as well, which you have obtained from the Clova Developer Console (using <a href="../References/Clova_Auth_API.html">Clova Auth API</a>). Get client credentials from the Clova Developer Console and have them ready in advance. Client credentials provide following information.</p>
<table>
<thead>
<tr>
<th>Credentials</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>CLOVA_OAUTH_CLIENT_ID</code></td>
<td>The client ID registered at the Clova Developer Console</td>
</tr>
<tr>
<td><code>CLOVA_OAUTH_CLIENT_SECRET</code></td>
<td>The client secret obtained from the Clova Developer Console</td>
</tr>
</tbody>
</table>
<div class="note">
  <p><strong>Note!</strong></p>
  <p>CIC exclusively for a client - The Clova Developer Console is currently under development. Contact your counterpart contact personnel to ask for help with obtaining client credentials.</p>
</div>

<h2 id="ConnectToCIC">Connecting with CIC </h2>
<p>To connect your client with CIC, complete the following steps.</p>
<ul>
<li><a href="#CreateClovaAccessToken">Creating Clova access token</a></li>
<li><a href="#CreateConnection">Creating connection</a></li>
<li><a href="#Authorization">Getting authorization</a></li>
<li><a href="#ManageConnection">Managing connection</a></li>
</ul>
<h3 id="CreateClovaAccessToken">Creating Clova access token </h3>
<p>To use Clova, users must authenticate their LINE account on your client (device or app). And, to attempt to connect your client with CIC, you must obtain a Clova access token, which has been authorized with its LINE account credentials. You use <a href="../References/Clova_Auth_API.html">Clova Auth API</a> for this process.</p>
<p>Below image displays the flow of how a client is obtaining the Clova access token.  The client is distinguished into two types and according to each type, the process of acquiring the Clova access token can vary.</p>
<ul>
<li>Device type client: A Clova service supported client which is embedded in speakers or home appliances.  The device type client provides an exclusive paired app to aid users since they can experience inconvenience with account authentication from such type.</li>
<li>App type client: A Clova service supported client which is in software just like the Clova app.</li>
</ul>
<p><img src="../Resources/Images/CIC_Authorization.png" alt=""></p>
<p>Below are the steps to obtain a Clova access token.</p>
<ol>
  <li>
    <p>In your client app or app paired with a client device, add an interface for users to authenticate their LINE account (<a href="https://developers.line.me/en/docs/line-login/web/integrate-line-login-v2/" target="_blank">LINE Login SDK</a>). You must use client app or paired app because user&apos;s speech input alone cannot handle account authentication.</p>
  </li>
  <li>
    <p>Obtain an access token for the LINE account, using the LINE account information entered by the user.</p>
  </li>
  <li>
    <p><a href="../References/Clova_Auth_API.html#RequestAuthorizationCode">Request an authorization code</a> by providing the LINE account access token and <a href="#ClientAuthInfo">client credentials</a>. Use client&apos;s MAC address with <code>device_id</code> field value or by generating UUID hash value. Below is an example of requesting an authorization code.</p>
    <pre><code>$ curl -H &apos;Authorization: Bearer QHSDAKLFJASlk12jlkf+asldkjasdf=sldkjf123dsalsdflkvpasdFMrjvi23scjaf123klv&apos;
    https://clova-authgw.line-apps.com/authorize \
    --data-urlencode &apos;client_id=c2Rmc2Rmc2FkZ2Fasdkjh234zZnNhZGZ&apos; \
    --data-urlencode &apos;device_id=aa123123d6-d900-48a1-b73b-aa6c156353206&apos; \
    --data-urlencode &apos;model_id=test_model&apos; \
    --data-urlencode &apos;response_type=code&apos; \
    --data-urlencode &apos;state=FKjaJfMlakjdfTVbES5ccZ&apos;
</code></pre>
    <p>The following is the body of the received response message. <code>code</code> field is the authorization code.</p>
    <pre><code>{
  &quot;code&quot;: &quot;cnl__eCSTdsdlkjfweyuxXvnlA&quot;,
  &quot;state&quot;: &quot;FKjaJfMlakjdfTVbES5ccZ&quot;
}
</code></pre></li>
  <li>
    <p>(If received <code>451 Unavailable For Legal Reasons</code> status code as a response to <a href="../References/Clova_Auth_API.html#RequestAuthorizationCode">authorization code request</a>) Find the URI recorded on <code>rediriec_uri</code> field from the message body and show terms and conditions agreement page to the user. Below is an example of a response message which will be received when the status code is <code>451 Unavailable For Legal Reasons</code>.</p>
    <pre><code>{
  &quot;code&quot;: &quot;4mrklvwoC_KNgDlvmslka&quot;,
  &quot;redirect_uri&quot;: &quot;https://ssl.pstatic.net/static/clova/service/terms/place/terms_3rd.html?code=4mrklvwoC_KNgDlvmslka&amp;grant_type=code&amp;state=FKjaJfMlakjdfTVbES5ccZ&quot;,
  &quot;state&quot;: &quot;FKjaJfMlakjdfTVbES5ccZ&quot;
}
</code></pre>
    <p>If the user does not agree to the terms and conditions, the next step cannot be processed. Once the user agrees to the terms and conditions and the result of agreement is sent to the server, your client will receive a response containing <code>302 Found</code>(URL Redirection) status code along with the following URL.</p>
    <ul>
      <li><code>clova://agreement-success</code> : The user successfully agreed to the terms and conditions. The client can continue to the next process to create the Clova access token.</li>
      <li><code>clova://agreement-failure</code> : The user failed to agree to the terms and conditions due to a server error. The client should exclude the failure properly.</li>
    </ul>
  </li>
  <li>
    <p>(If it is a paired app) Forward the authorization code to the client device.</p>
  </li>
  <li>
    <p>Pass the authorization code and <a href="#ClientAuthInfo">client credentials</a> as parameters and <a href="../References/Clova_Auth_API.html#RequestClovaAccessToken">request a Clova access token</a>. Below is an example of requesting a Clova access token.</p>
    <pre><code>$ curl https://clova-authgw.line-apps.com/token?grant_type=authorization_code \
    --data-urlencode &apos;client_id=c2Rmc2Rmc2FkZ2Fasdkjh234zZnNhZGZ&apos; \
    --data-urlencode &apos;client_secret=66qo65asdfasdfaA7JasdfasfOqwnOq1rOyfgeydtCDrvYasfasf%3D&apos; \
    --data-urlencode &apos;code=cnl__eCSTdsdlkjfweyuxXvnlA&apos; \
    --data-urlencode &apos;device_id=aa123123d6-d900-48a1-b73b-aa6c156353206&apos; \
    --data-urlencode &apos;model_id=test_model&apos;
</code></pre>
    <p>The Clova access token is returned as follows.</p>
    <pre><code>{
    &quot;access_token&quot;: &quot;XHapQasdfsdfFsdfasdflQQ7w&quot;,
    &quot;expires_in&quot;: 332000,
    &quot;refresh_token&quot;: &quot;GW-Ipsdfasdfdfs3IbHFBA&quot;,
    &quot;token_type&quot;: &quot;Bearer&quot;
}
</code></pre>
  </li>
</ol>

<h3 id="CreateConnection">Creating CIC connection </h3>
<p>To establish an initial connection between your client and CIC, the first thing to do is <a href="../References/CIC_API.html#EstablishDownchannel">creating a downchannel</a>. A downchannel is used when you receive directive messages from CIC. These directive messages are not responses prompted by event messages. They are messages initiated exclusively by CIC (cloud-initiated) when certain conditions are met or when any needs arise. For example, when a new alarm (push) arrives, a directive message will be sent through a downchannel.</p>
<p>To create a downchannel, send a <code>GET</code> request to <code>/v1/directives</code>. Once a downchannel is established, CIC keeps the connection open.</p>
<pre><code>:method: GET
:scheme: https
:path = /v1/directives
Authorization: Bearer {{ClovaAccessToken}}
</code></pre><p>When the connection request is processed successfully, CIC returns a <a href="../References/CICInterface/Clova.html#Hello"><code>Clova.Hello</code></a> directive message as a response. It indicates that CIC is ready to send more directive messages through the downchannel.</p>
<pre><code>{
    &quot;directive&quot;: {
        &quot;header&quot;: {
            &quot;messageId&quot;: &quot;2ca2ec70-c39d-4741-8a34-8aedd3b24760&quot;,
            &quot;namespace&quot;: &quot;Clova&quot;,
            &quot;name&quot;: &quot;Hello&quot;
        },
        &quot;payload&quot;: {}
    }
}
</code></pre><div class="note">
  <p><strong>Note!</strong></p>
  <ul>
    <li>Once a client app or device has started, it must always maintain one active downchannel with CIC. If any new request is sent to <code>/v1/directives</code> when an active downchannel already exists, that existing downchannel will be closed.</li>
    <li>See <a href="#Authorization">Getting authorization</a> for more details on filling in the Authorization header field.</li>
  </ul>
</div>


<h3 id="Authorization">Getting authorization </h3>
<p>When sending requests to CIC, you must send <a href="#CreateClovaAccessToken">Clova access tokens</a> along with the requests. Enter Clova access token&apos;s type and value, separated by a space, in the Authorization header field as follows. See <a href="../References/CIC_API.html">CIC API reference</a> for more details.</p>
<pre><code>:method: {{GET|POST}}
:scheme: https
:path = {{/v1/events|/v1/directives}}
Authorization: Bearer {{ClovaAccessToken}}
</code></pre><p>Every time you send a new request (event message), you must send a Clova access token together as shown in the picture below.</p>
<p><img src="../Resources/Images/CIC_Message_Interaction_Diagram.png" alt=""></p>
<h3 id="ManageConnection">Managing connection </h3>
<p>Once a connection is established between your client and CIC, manage the connection by running the following tasks.</p>
<ul>
<li><a href="#KeepDownchannel">Maintaining downchannel</a></li>
<li><a href="#DoPingpong">Performing ping-pong</a></li>
<li><a href="#RefreshAccessToken">Refreshing access token</a></li>
</ul>
<h4 id="KeepDownchannel">Maintaining downchannel </h4>
<p>When an existing downchannel is closed or disconnected, <a href="#CreateConnection">create a new downchannel</a> immediately to prevent from failing to receive directive messages from CIC.</p>
<h4 id="DoPingpong">Performing ping-pong </h4>
<p>Send HTTP/2 PING frames to CIC in every 1 minute to confirm connectivity with CIC. When failing to receive HTTP/2 PING ACK responses from CIC, establish a new connection immediately to maintain a connection between your client and CIC. Refer to <a href="https://http2.github.io/http2-spec/#rfc.figure.12" target="_blank">HTTP/2 PING Payload Format</a> for more details on the HTTP/2 PING frame.</p>
<div class="note">
  <p><strong>Note!</strong></p>
  <p>If your client cannot send HTTP/2 PING frames, it must send <code>GET</code> requests to <code>/ping</code> every 1 minute, at which points, it will receive an HTTP 204 No Content response. As is the case with HTTP/2 PING frames, if it fails to receive responses, establish a new connection immediately.</p>
  <p>This is an example of sending a <code>GET</code> request to <code>/ping</code>.</p>
  <pre><code>:method = GET
:scheme = https
:path = /ping
Authorization = Bearer 
</code></pre>
</div>

<h4 id="RefreshAccessToken">Refreshing access token </h4>
<p>When obtaining an access token, you can check its expiry time from the <code>expires_in</code> field. If the time expires, or if you receive an <a href="../References/CIC_API.html#Error">error message</a> that reads, &quot;HTTP 401 Unauthorized&quot;, you must refresh the access token. <a href="../References/Clova_Auth_API.html#RefreshClovaAccessToken">To refresh the Clova access token</a>, send the refresh token (<code>refresh_token</code>) you have received when <a href="../References/Clova_Auth_API.html#RequestClovaAccessToken">obtaining the Clova access token</a> and pass required parameters, as shown below.</p>
<pre><code>$ curl https://clova-authgw.line-apps.com/token?grant_type=refresh_token \
       --data-urlencode &apos;client_id=c2Rmc2Rmc2FkZ2FzZnNhZGZ&apos; \
       --data-urlencode &apos;client_secret=66qo65asdfasdfaA7JasdfasfOqwnOq1rOyfgeydtCDrvYasfasf%3D&apos; \
       --data-urlencode &apos;refresh_token=GW-Ipsdfasdfdfs3IbHFBA&apos; \
       --data-urlencode &apos;device_id=aa123123d6-d900-48a1-b73b-aa6c156353206&apos; \
       --data-urlencode &apos;model_id=test_model&apos;
</code></pre>


<h2 id="SendEvent">Sending event message </h2>
<p>Clients can send <a href="../References/CIC_API.html#Event">event messages</a> to CIC. You use event messages to send client requests to CIC. An event message can be either a JSON-format message or a <a href="../References/CIC_API.html#MultipartMessage">multipart message</a> that carries user&apos;s speech input.</p>
<p>To send user&apos;s speech data to CIC, use a <a href="../References/CICInterface/SpeechRecognizer.html#Recognize"><code>SpeechRecognizer.Recognize</code></a> event message. The following explains how to send an event message to CIC using <code>SpeechRecognizer.Recognize</code>.</p>
<ol>
<li><p>Prepare <a href="#RequiredLibrary">HTTP/2 library</a> and <a href="#Authorization">Clova access token</a> in your client.</p>
</li>
<li><p>Fill in the HTTP header with appropriate values as described in <a href="../References/CIC_API.html#SendEvent">CIC API</a> and send a request using the HTTP/2 library.</p>
<pre><code>:method = POST
:scheme = https
:path = /v1/events
Authorization = Bearer XHapQasdfsdfFsdfasdflQQ7w-Example
content-type = multipart/form-data; boundary=Boundary-Text
</code></pre>
</li>
<li><p>Create a <a href="../CIC_Overview.html#DialogModel">dialog ID</a> (<code>dialogRequestId</code>) and a message ID (messageId) in UUID format to include in the event message. You create and send a uniquely identifiable dialog ID and a message ID to find a matching directive message from <a href="#ManageMessageQ">message queues</a> later.</p></li>
<li><p>In the first message part, write a JSON-format event message and a message header as described in the <a href="../References/CICInterface/SpeechRecognizer.html#Recognize"><code>SpeechRecognizer.Recognize</code></a> API specification and send it to CIC.</p>
<pre><code>--Boundary-Text
Content-Disposition: form-data; name=&quot;metadata&quot;
Content-Type: application/json; charset=UTF-8
{
  &quot;context&quot;: [
    {
      &quot;header&quot;: {
        &quot;namespace&quot;: &quot;Speaker&quot;,
        &quot;name&quot;: &quot;VolumeState&quot;
      },
      &quot;payload&quot;: {
        &quot;volume&quot;: 25,
        &quot;muted&quot;: false
      }
    }
  ],
  &quot;event&quot;: {
    &quot;header&quot;: {
      &quot;namespace&quot;: &quot;SpeechRecognizer&quot;,
      &quot;name&quot;: &quot;Recognize&quot;,
      &quot;messageId&quot;: &quot;277b40c3-b046-4f61-a551-783b1547e7b7&quot;,
      &quot;dialogRequestId&quot;: &quot;4e4080d6-c440-498a-bb73-ae86c6312806&quot;
    },
    &quot;payload&quot;: {
      &quot;profile&quot;: &quot;CLOSE_TALK&quot;
    }
  }
}
--Boundary-Text--
</code></pre>
</li>
<li>From the second message part, send the user&apos;s speech data by capturing it with the interval of 200ms. As the data type has changed, write the message header as follows.
<pre><code>--Boundary-Text
Content-Disposition: form-data; name=&quot;audio&quot;
Content-Type: application/octet-stream
[[ binary audio attachment ]]
--Boundary-Text--
</code></pre>
</li>
<li><p>Continue to send the speech data until the user finishes speech input or CIC returns a <a href="../References/CICInterface/SpeechRecognizer.html#StopCapture"><code>SpeechRecognizer.StopCapture</code></a> directive message. Once the sending is complete, CIC returns an HTTP response message.</p>
</li>
</ol>

<div class="note">
  <p><strong>Note!</strong></p>
  <p>Using <a href="../References/CICInterface/TextRecognizer.html#Recognize"><code>TextRecognizer.Recognize</code></a> allows you to process text input by users.</p>
</div>

<h2 id="HandleDirective">Handling directive message </h2>
<p>CIC returns directive messages to instruct your client to perform specific actions. A directive message is either a response to an <a href="#SendEvent">event message</a> or a message sent through a downchannel created at an initial connection with CIC. Responses are usually a <a href="../References/CIC_API.html#MultipartMessage">multipart message</a>. A JSON-format <a href="../References/CIC_API.html#Directive">directive message</a> is returned first, followed by subsequent messages containing additional information (speech data, content details) as specified by the <a href="../References/CIC_API.html">CIC messages</a>.</p>
<table>
<thead>
<tr>
<th>Content type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Speech data</td>
<td>Speech audio to play through a device speaker</td>
</tr>
<tr>
<td>JSON content data</td>
<td><ul><li>Data to be displayed on a device screen (See <a href="../References/Content_Templates.html">Content template</a>)</li><li>Data that contains content&apos;s location (for example, music to play) and its credentials</li></ul></td>
</tr>
</tbody>
</table>
<p>Implement your client to handle directive messages in the following steps.</p>
<ol>
<li><p>When a directive message is returned in response to an event message or is sent through a downchannel, store the message in a preset <a href="#ManageMessageQ">message queue</a>.</p>
</li>
<li><p>Parse the message header of the <a href="../References/CIC_API.html#Directive">directive message</a>. Generally, use <code>dialogRequestId</code> to find the user request, and <code>namespace</code> and <code>name</code> to determine which <a href="../References/CIC_API.html">API</a> is used. Below is an example of a directive message received.</p>
<pre><code>{
  &quot;directive&quot;: {
    &quot;header&quot;: {
      &quot;namespace&quot;: &quot;SpeechSynthesizer&quot;,
      &quot;name&quot;: &quot;Speak&quot;,
      &quot;messageId&quot;: &quot;277b40c3-b046-4f61-a551-783b1547e7b7&quot;,
      &quot;dialogRequestId&quot;: &quot;4e4080d6-c440-498a-bb73-ae86c6312806&quot;
    },
    &quot;payload&quot;: {
      &quot;format&quot;: &quot;AUDIO_MPEG&quot;,
      &quot;token&quot;: &quot;b5fa5144-1e55-4193-8628-c70283083d9b&quot;,
      &quot;ttsLang&quot;: &quot;ko&quot;
      &quot;url&quot;: &quot;cid:9d5d37a3-0e70-41a6-a671-e1a40c7ea4d8&quot;,
      &quot;x-clova-pause-before&quot;: 0
    }
  }
}
</code></pre>
</li>
<li>Check whether the <a href="../CIC_Overview.html#DialogModel">dialog ID</a>(<code>dialogRequestId</code>) of the directive message matches the dialog ID kept on the client.
<ul>
<li><p><strong>If it matches the dialog ID kept on the client</strong>, perform necessary actions as specified by the API. Usually, you can pick out additional necessary information (speech data) from <a href="#ManageMessageQ">message queues</a>, <a href="../References/CICInterface/SpeechSynthesizer.html#Speak">using the<code>cid</code> value</a> contained in <code>payload</code> of the directive message. <code>cid</code> indicates a `Content-Id` message header of speech data returned in a multipart message, as shown below.</p>
<pre><code>--b4bc211bbd32e5cb5989bc7ab2d3088fdd72dcc6696253151c98176f88ba
Content-Disposition: form-data; name=&quot;attachment-39b2f844-b168-4dc2-bea7-d5c249e446e3&quot;
Content-Id: d329085c-379e-48aa-b871-7ecebdbe831d
Content-Type: application/octet-stream
[[ binary audio attachment ]]
--b4bc211bbd32e5cb5989bc7ab2d3088fdd72dcc6696253151c98176f88ba
</code></pre>
</li>
<li><strong>If it does not match the dialog ID kept on the client</strong>, disregard the directive message and all related messages and remove them from the queue.</li>
</ul>
</li>
</ol>

<h2 id="ManageMessageQ">Managing message queue </h2>
<p>Sending and receiving messages to and from CIC occur in a consecutive way. When CIC returns directive messages, they have the following characteristics.</p>
<ul>
<li>CIC can return multiple directive messages and messages for additional information at one time.</li>
<li>CIC can return directive messages not only through a downchannel but also through a response message to an event message.</li>
<li>CIC can return directive messages with different dialog IDs.</li>
<li>CIC does not return directive messages in a sequential order.</li>
</ul>
<p>Because of these characteristics, you must use a queue-based data structure to put in and take out messages in a sequential order, whether the messages are responses to event messages or whether they are messages sent through a downchannel. We call this data structure a &quot;message queue.&quot;</p>
<p>Develop your client to process directive messages one at a time as they are enqueued in each message queue. Also, the message in processing must correspond to the last user request in your client. User requests are identifiable by <a href="../CIC_Overview.html#DialogModel">dialog IDs</a> and the dialog ID of the last request must be kept at the client side. If your client is keeping any directive message which has a canceled dialog ID in a message queue, such message and its related information must be removed from the queue.</p>
<p>Determine the following rules in consideration of your UX design plan.</p>
<ul>
<li>The number of message queues and their size</li>
<li>Processing priority of message queues</li>
</ul>
<p>If you provide UX that runs tasks seamlessly while your client is receiving speech input or playing speech audio, such as music playback (<a href="../References/CICInterface/AudioPlayer.html">AudioPlayer</a>), process message queues separately for such directive messages. Some API namespaces send a single directive message simultaneously. For such namespaces, you do not have to manage message queues separately.</p>

                                
                                </section>
                            
                        </div>
                    </div>
                
            </div>

            
                
                <a href="../CIC_Overview.html#DialogModel" class="navigation navigation-prev " aria-label="Previous page: Dialog model">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="Interact_with_CIC.html#Preparation" class="navigation navigation-next " aria-label="Next page: Preparation">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Interacting with CIC","level":"2.2","depth":1,"next":{"title":"Preparation","level":"2.2.1","depth":2,"anchor":"#Preparation","path":"CIC/Guides/Interact_with_CIC.md","ref":"CIC/Guides/Interact_with_CIC.md#Preparation","articles":[]},"previous":{"title":"Dialog model","level":"2.1.3","depth":2,"anchor":"#DialogModel","path":"CIC/CIC_Overview.md","ref":"CIC/CIC_Overview.md#DialogModel","articles":[]},"dir":"ltr"},"config":{"plugins":"-search","styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"page-toc-button":{"maxTocDepth":4,"minTocSize":2},"toggle-children":{},"highlight":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","author":"LINE Corp.","pdf":{"pageNumbers":true,"fontSize":11,"fontFamily":"Arial","paperSize":"a3","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":30,"left":30,"top":40,"bottom":40}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{"DocVersion":"v2.0","CICBaseURL":"https://clova-cic.line-apps.com/","ClassifiedInfo":"Confidential","RedirectURLforAccountLinking":"https://prod-ni-cic.clova.ai/v1/al/token/","OrientedService":"LINE","AuthServerBaseURL":"https://clova-authgw.line-apps.com/","TargetServiceForClientAuth":"LINE","Locale":"en-JP","DocOwner":"LINE","LoginAPIofTargetService":"https://developers.line.me/en/docs/line-login/web/integrate-line-login-v2/"},"title":"Clova Developer Guide","language":"en","gitbook":"*","description":"This documentation provides developer guides as well as API references for CIC and CEK platforms provided by Clova.","direction":"ltr"},"file":{"path":"CIC/Guides/Interact_with_CIC.md","mtime":"2017-12-22T02:08:26.845Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2017-12-22T08:22:59.286Z"},"basePath":"../..","book":{"language":"en"}});
        });
    </script>
</div>

        
    <script src="../../../gitbook/gitbook.js"></script>
    <script src="../../../gitbook/theme.js"></script>
    
        
        <script src="../../../gitbook/gitbook-plugin-toggle-children/toggle.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-page-toc-button/plugin.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

